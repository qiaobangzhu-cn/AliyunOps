@echo off
SetLocal EnableDelayedExpansion
rem rule CVE-2016-8610

rem Death Alert-OpenSSL (remote Dos)

rem It was found that function "ssl3_read_bytes" in ssl/s3_pkt.c might lead to higher CPU usage due to improper handling of warning packets

rem All 0.9.8
rem All 1.0.1
rem 1.0.2
rem 1.0.2a
rem 1.0.2b
rem 1.0.2c
rem 1.0.2d
rem 1.0.2e
rem 1.0.2f
rem 1.0.2g
rem 1.0.2h
rem 1.1.0

set Affected=1
set NotAffected=0

set InsInfoFile=%~1

call GetKeyValue.bat "%InsInfoFile%" "openssl"
set openssl=%Value%

set Return=%NotAffected%

for /f "delims=-" %%A in ("!openssl!") do set OpensslVersion=%%A

rem All 0.9.8
echo !OpensslVersion!|find "0.9.8" >nul
if NOT errorlevel 1 set Return=!Affected!

rem All 1.0.1
echo !OpensslVersion!|find "0.9.8" >nul
if NOT errorlevel 1 set Return=!Affected!

if "!OpensslVersion!"=="1.0.2"  set Return=!Affected!
if "!OpensslVersion!"=="1.0.2a" set Return=!Affected!
if "!OpensslVersion!"=="1.0.2b" set Return=!Affected!
if "!OpensslVersion!"=="1.0.2c" set Return=!Affected!
if "!OpensslVersion!"=="1.0.2d" set Return=!Affected!
if "!OpensslVersion!"=="1.0.2e" set Return=!Affected!
if "!OpensslVersion!"=="1.0.2f" set Return=!Affected!
if "!OpensslVersion!"=="1.0.2g" set Return=!Affected!
if "!OpensslVersion!"=="1.0.2h" set Return=!Affected!

if "!OpensslVersion!"=="1.1.0"  set Return=!Affected!

exit/b %Return%
