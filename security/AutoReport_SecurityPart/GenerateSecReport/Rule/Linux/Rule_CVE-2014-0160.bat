@echo off
SetLocal EnableDelayedExpansion
rem rule CVE-2014-0160

rem the Heartbleed bug

rem The (1) TLS and (2) DTLS implementations in OpenSSL 1.0.1 before 1.0.1g do not properly handle Heartbeat Extension packets, which allows remote attackers
rem to obtain sensitive information from process memory via crafted packets that trigger a buffer over-read, as demonstrated by reading private keys, related to d1_both.c and t1_lib.c

rem 1.0.1
rem 1.0.1a
rem 1.0.1b
rem 1.0.1c
rem 1.0.1d
rem 1.0.1e
rem 1.0.1f

set Affected=1
set NotAffected=0

set InsInfoFile=%~1

call GetKeyValue.bat "%InsInfoFile%" "openssl"
set openssl=%Value%

set Return=%NotAffected%

for /f "delims=-" %%A in ("!openssl!") do set OpensslVersion=%%A

if "!OpensslVersion!"=="1.0.1"  set Return=!Affected!
if "!OpensslVersion!"=="1.0.1a" set Return=!Affected!
if "!OpensslVersion!"=="1.0.1b" set Return=!Affected!
if "!OpensslVersion!"=="1.0.1c" set Return=!Affected!
if "!OpensslVersion!"=="1.0.1d" set Return=!Affected!
if "!OpensslVersion!"=="1.0.1e" set Return=!Affected!
if "!OpensslVersion!"=="1.0.1f" set Return=!Affected!

exit/b %Return%
