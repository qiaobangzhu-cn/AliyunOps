@echo off
SetLocal EnableDelayedExpansion
rem rule CVE-2016-7543

rem local users to execute arbitrary commands with root privileges 

rem Bash before 4.4 allows local users to execute arbitrary commands with root privileges via crafted SHELLOPTS and PS4 environment variables

rem < 4.4

set Affected=1
set NotAffected=0

set InsInfoFile=%~1

call GetKeyValue.bat "%InsInfoFile%" "shell"
set shell=%Value%

set Return=%NotAffected%
for /f "tokens=4" %%A in ("!shell!") do set ShellVersion=%%A
for /f "delims=(" %%A in ("!ShellVersion!") do set ShellVersion=%%A

call VersionComp.bat 4.4 !ShellVersion!
if !errorlevel! equ 1 set Return=!Affected!

exit/b %Return%
