@echo off
SetLocal EnableDelayedExpansion
rem rule CVE-2014-6271

rem Remote Code Execution

rem GNU Bash through 4.3 processes trailing strings after function definitions in the values of environment variables,
rem which allows remote attackers to execute arbitrary code via a crafted environment

rem < 4.4

set Affected=1
set NotAffected=0

set InsInfoFile=%~1

call GetKeyValue.bat "%InsInfoFile%" "shell"
set shell=%Value%

set Return=%NotAffected%
for /f "tokens=4" %%A in ("!shell!") do set ShellVersion=%%A
for /f "delims=(" %%A in ("!ShellVersion!") do set ShellVersion=%%A

call VersionComp.bat 4.4 !ShellVersion!
if !errorlevel! equ 1 set Return=!Affected!

exit/b %Return%
